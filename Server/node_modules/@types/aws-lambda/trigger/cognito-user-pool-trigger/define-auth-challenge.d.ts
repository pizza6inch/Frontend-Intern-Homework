import { Handler } from "../../handler";
import { BaseTriggerEvent, ChallengeResult, CustomChallengeResult, StringMap } from "./_common";

/**
 * An event type for the Cognito User Pool custom authentication flow define auth challenge trigger.
 * 
 * @see https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-define-auth-challenge.html
 */
export interface DefineAuthChallengeTriggerEvent extends BaseTriggerEvent<"DefineAuthChallenge_Authentication"> {
    /**
     * Request data, including user attributes, session data, and optional user not found and client metadata fields.
     */
    request: {
        userAttributes: StringMap;
        session: Array<ChallengeResult | CustomChallengeResult>;
        userNotFound?: boolean | undefined;
        clientMetadata?: StringMap | undefined;
    };
    /**
     * Response data, including the challenge name, failure of authentication, and issuing of tokens.
     */
    response: {
        challengeName: string;
        failAuthentication: boolean;
        issueTokens: boolean;
    };
}

/**
 * A type alias for a handler function that handles the `DefineAuthChallengeTriggerEvent` type.
 */
export type DefineAuthChallengeTriggerHandler = Handler<DefineAuthChallengeTriggerEvent>;


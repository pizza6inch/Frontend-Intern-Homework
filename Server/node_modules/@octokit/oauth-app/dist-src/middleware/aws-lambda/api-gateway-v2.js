// Import necessary modules: parseRequest, sendResponse from api-gateway-v2-parse-request and api-gateway-v2-send-response.js files, and handleRequest from handle-request.js file.
import { parseRequest } from "./api-gateway-v2-parse-request";
import { sendResponse } from "./api-gateway-v2-send-response.js";
import { handleRequest } from "../handle-request.js";

// Create the AWS Lambda API Gateway V2 handler function with app and options parameters
function createAWSLambdaAPIGatewayV2Handler(app, options = {}) {
  // Return an async function that accepts an event parameter
  return async function(event) {
    // Parse the event using parseRequest and store the result in the request variable
    const request = parseRequest(event);
    
    // Call the handleRequest function with app, options, and request as arguments, and wait for the result
    const response = await handleRequest(app, options, request);
    
    // If a response is available, send it using sendResponse and return the result
    if (response) {
      return sendResponse(response);
    }
    // If no response is available, return undefined
    else {
      return void 0;
    }
  };
}

// Export the createAWSLambdaAPIGatewayV2Handler function
export {
  createAWSLambdaAPIGatewayV2Handler
};

/*!
 * node-domexception. MIT License. Jimmy WÃ¤rting <https://jimmy.warting.se/opensource>
 *
 * This module exports the DOMException constructor for use in Node.js environments.
 * It first checks if the constructor is already available in the global `this` object.
 * If it's not available, the code creates a `MessageChannel` from the `worker_threads`
 * module and uses it to post an `ArrayBuffer` to the other port. If this results in a
 * `DOMException`, the constructor is assigned to the `globalThis.DOMException` property.
 */

if (!globalThis.DOMException) {
  // If the DOMException constructor is not already available in the globalThis object...

  try {
    // Attempt to create a MessageChannel from the worker_threads module and use it to post an ArrayBuffer to the other port.
    const { MessageChannel } = require('worker_threads'),
          port = new MessageChannel().port1,
          ab = new ArrayBuffer()
    port.postMessage(ab, [ab, ab])
  } catch (err) {
    // If this results in a DOMException, assign the constructor to the globalThis.DOMException property.
    if (err.constructor.name === 'DOMException') {
      globalThis.DOMException = err.constructor
    }
  }
}

module.exports = globalThis.DOMException


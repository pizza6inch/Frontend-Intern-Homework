#!/usr/bin/env pwsh
# This line is a shebang used to specify the interpreter for the script.
# In this case, it's set to PowerShell (pwsh).

$basedir=Split-Path $MyInvocation.MyCommand.Definition -Parent
# The $basedir variable is assigned the parent directory path of the script.

$exe=""
if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) {
  # This if statement checks if the PowerShell version is lower than 6.0
  # or if the script is running on Windows. If either condition is true,
  # the $exe variable is left empty.
  $exe=".exe"
  # If the script is running on Windows or PowerShell version is lower than 6.0,
  # the $exe variable is set to ".exe" to indicate the Node.js executable with .exe extension.
}

$ret=0
# The $ret variable is initialized to 0, which will store the exit code of the Node.js process.

if (Test-Path "$basedir/node$exe") {
  # This if statement checks if the local Node.js executable exists in the script's parent directory.
  if ($MyInvocation.ExpectingInput) {
    # This if statement checks if the script is expecting input from the pipeline.
    $input | & "$basedir/node

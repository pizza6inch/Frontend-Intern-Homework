import { Handler } from "../../handler";
import { BaseTriggerEvent, ChallengeResult, CustomChallengeResult, StringMap } from "./_common";

/**
 * An event object that is passed to a Lambda function when Amazon Cognito User Pool triggers a "CreateAuthChallenge" event.
 * This event is triggered when a user is prompted to complete a challenge to authenticate their identity.
 *
 * @see https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-create-auth-challenge.html
 */
export interface CreateAuthChallengeTriggerEvent extends BaseTriggerEvent<"CreateAuthChallenge_Authentication"> {
    /**
     * The request object that contains information about the user attributes, challenge name, session, and other metadata.
     */
    request: {
        /**
         * A map of user attributes that are relevant to the authentication process.
         */
        userAttributes: StringMap;

        /**
         * The name of the challenge that the user is being prompted to complete.
         */
        challengeName: string;

        /**
         * An array of challenge results or custom challenge results that have been completed by the user.
         */
        session: Array<ChallengeResult | CustomChallengeResult>;

        /**
         * A boolean value that indicates whether the user was not found during the authentication process.
         */
        userNotFound?: boolean | undefined;

        /**
         * A map of metadata that was provided by the client during the authentication process.
         */
        clientMetadata?: StringMap | undefined;
    };

    /**
     * The response object that contains information about the public and private challenge parameters, as well as the challenge metadata.
     */
    response: {
        /**
         * A map of public challenge parameters that are relevant to the authentication process.
         */
        publicChallengeParameters: StringMap;

        /**
         * A map of private challenge parameters that are relevant to the authentication process.
         */
        privateChallengeParameters: StringMap
